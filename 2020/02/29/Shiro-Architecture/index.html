<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="baidu-site-verification" content="093lY4ziMu" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="sunshine&#39;s blog">
    <meta name="keyword"  content="blog, hexo-theme-snail">
    <link rel="shortcut icon" href="/sunshine-carroll.github.io/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!--<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>-->
    <title>
        
          Shiro-Architecture - sunshine
        
    </title>

    <link rel="canonical" href="https://sunshine-carroll.github.io/sunshine-carroll.github.io/2020/02/29/Shiro-Architecture/">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/sunshine-carroll.github.io/css/bootstrap.min.css">


    <!-- Custom CSS --> 
    
        
<link rel="stylesheet" href="/sunshine-carroll.github.io/css/dusign-light.css">

        
<link rel="stylesheet" href="/sunshine-carroll.github.io/css/dusign-common-light.css">

        
<link rel="stylesheet" href="/sunshine-carroll.github.io/css/font-awesome.css">

        
<link rel="stylesheet" href="/sunshine-carroll.github.io/css/toc.css">

        <!-- background effects end -->
    
    
    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/sunshine-carroll.github.io/css/highlight.css">


    
<link rel="stylesheet" href="/sunshine-carroll.github.io/css/widget.css">


    
<link rel="stylesheet" href="/sunshine-carroll.github.io/css/rocket.css">


    
<link rel="stylesheet" href="/sunshine-carroll.github.io/css/signature.css">


    
<link rel="stylesheet" href="/sunshine-carroll.github.io/css/fonts.googleapis.css">


    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <!-- photography -->
    
<link rel="stylesheet" href="/sunshine-carroll.github.io/css/photography.css">


    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 4.2.0"></head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- background effects start -->
    
    <!-- background effects end -->

	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            
                background-image: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url('')
                /*post*/
            
        
    }
    
    #signature{
        background-image: url('/sunshine-carroll.github.io/img/signature/dusign.png');
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/sunshine-carroll.github.io/tags/#Shiro" title="Shiro">Shiro</a>
                            
                              <a class="tag" href="/sunshine-carroll.github.io/tags/#work" title="work">work</a>
                            
                        </div>
                        <h1>Shiro-Architecture</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by sunshine on
                            2020-02-29
                        </span>

                        
                            <div class="blank_box"></div>
                            <span class="meta">
                                Words <span class="post-count">3.9k</span> and
                                Reading Time <span class="post-count">17</span> Minutes
                            </span>
                            <div class="blank_box"></div>
                            <!-- ä¸è’œå­ç»Ÿè®¡ start -->
                            <span class="meta">
                                Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
                            </span>
                            <!-- ä¸è’œå­ç»Ÿè®¡ end -->
                        

                    </div>
                

                </div>
            </div>
        </div>      
    </div>

    
    <div class="waveWrapper">
        <div class="wave wave_before" style="background-image: url('/img/wave-light.png')"></div>
        <div class="wave wave_after" style="background-image: url('/img/wave-light.png')"></div>
    </div>
    
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/sunshine-carroll.github.io/">Sunshine&#39;s Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/sunshine-carroll.github.io/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/sunshine-carroll.github.io/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/sunshine-carroll.github.io/categories/">Categories</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/sunshine-carroll.github.io/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/sunshine-carroll.github.io/photography/">Photography</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/sunshine-carroll.github.io/tags/">Tags</a>
                        </li>
                        
                    
                    
                    
                    <li>
                        <a href="YOUR_CHINESE_BLOG_URL" target="_blank">Chinese Blog</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <p>ç¿»è¯‘è‡ªå®˜æ–¹æ–‡æ¡£â€”<a href="http://shiro.apache.org/architecture.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>
<h2 id="Apache-Shiro-Architecture-ï¼ˆApache-Shiro-æ¶æ„"><a href="#Apache-Shiro-Architecture-ï¼ˆApache-Shiro-æ¶æ„" class="headerlink" title="Apache Shiro Architecture ï¼ˆApache Shiro æ¶æ„)"></a>Apache Shiro Architecture ï¼ˆApache Shiro æ¶æ„)</h2><p>Apache Shiroâ€™s design goals are to simplify application security by being intuitive and easy to use. Shiroâ€™s core design models how most people think about application security - in the context of someone (or something) interacting with an application.  </p>
<p>Aache Shiroè®¾è®¡çš„ç›®æ ‡æ˜¯é€šè¿‡ç›´è§‰åŒ–å’Œç®€æ˜“å®ç”¨è®¾è®¡æ¥ç®€åŒ–åº”ç”¨ç¨‹åºå®‰å…¨æ€§å¼€å‘. Shiro æ ¸å¿ƒè®¾è®¡æ¨¡å‹æ˜¯ åœ¨æŸäººæˆ–æŸç‰©ä¸åº”ç”¨ç¨‹åºäº¤äº’çš„åœºæ™¯ä¸‹ï¼Œäººä»¬å¯¹åº”ç”¨ç¨‹åºå®‰å…¨æ€ç»´æ–¹å¼ </p>
<hr>
<p>Software applications are usually designed based on user stories. That is, youâ€™ll often design user interfaces or service APIs based on how a user would (or should) interact with the software. For example, you might say, â€œIf the user interacting with my application is logged in, I will show them a button they can click to view their account information. If they are not logged in, I will show a sign-up button.â€</p>
<p>åº”ç”¨ç¨‹åºè½¯ä»¶é€šå¸¸åŸºäºç”¨æˆ·æ•…äº‹è®¾è®¡ã€‚è¿™æ„å‘³ç€ï¼Œä½ å°†åœ¨è®¾è®¡ç”¨æˆ·æ¥å£æˆ–æœåŠ¡APIæ—¶ç»å¸¸åŸºäºä¸€ä¸ªç”¨æˆ·å°†(æˆ–åº”è¯¥)å¦‚ä½•å’Œè½¯ä»¶äº¤äº’ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½ å¯èƒ½ä¼šè¯´â€å¦‚æœä¸€ä¸ªç”¨æˆ·ä¸æˆ‘ç¨‹åºäº¤äº’å¼å·²ç»ç™»å…¥ï¼Œæˆ‘å°†ç»™ä»–ä»¬å±•ç¤ºä¸€ä¸ªå¯ä»¥ç‚¹å‡»æŸ¥çœ‹ä»–ä»¬è´¦æˆ·ä¿¡æ¯çš„æŒ‰é’®ï¼Œå¦‚æœä»–ä»¬æ²¡æœ‰ç™»å…¥ï¼Œæˆ‘å°†å±•ç¤ºä¸€ä¸ªæ³¨å†ŒæŒ‰é’®â€</p>
<hr>
<p>This example statement indicates that applications are largely written to satisfy user requirements and needs. Even if the â€˜userâ€™ is another software system and not a human being, you still write code to reflect behavior based on who (or what) is currently interacting with your software.</p>
<p>è¿™ä¸ªä¾‹å­çš„é™ˆè¿°è¡¨æ˜ä¸€ä¸ªåº”ç”¨ç¨‹åºé€šå¸¸ä¸ºäº†æ»¡è¶³ç”¨æˆ·è¦æ±‚æˆ–éœ€æ±‚è€Œç¼–å†™ã€‚ç”šè‡³è¿™ä¸ªâ€ç”¨æˆ·â€æ˜¯å…¶ä»–è½¯ä»¶ç³»ç»Ÿè€Œéäººç±»æ—¶ï¼Œä½ ä»éœ€è¦åŸºäºå½“å‰ä¸ä½ çš„è½¯ä»¶ç³»ç»Ÿäº¤äº’çš„äººæˆ–ç‰©è¡¨ç°å‡ºçš„è¡Œä¸ºæ¥ç¼–å†™ä»£ç </p>
<hr>
<p>Shiro reflects these concepts in its own design. By matching what is already intuitive for software developers, Apache Shiro remains intuitive and easy to use in practically any application.</p>
<p>Shiro ä½¿ç”¨è‡ªèº«çš„è®¾è®¡æ¥è¡¨ç°è¿™äº›æ¦‚å¿µã€‚é€šè¿‡è”ç³»å¯¹äºè½¯ä»¶å¼€å‘è€…æ¥è¯´å·²æœ‰çš„ç›´è§‚äº‹ç‰©ï¼ŒApache Shiro å‡ ä¹å¯ä»¥åœ¨ä»»æ„åº”ç”¨ä¸­ä¿ç•™ç›´è§‚æ€§å’Œæ˜“ç”¨æ€§</p>
<h2 id="Hign-Level-Overview-é«˜å±‚æ€»è§ˆ"><a href="#Hign-Level-Overview-é«˜å±‚æ€»è§ˆ" class="headerlink" title="Hign-Level Overview (é«˜å±‚æ€»è§ˆ)"></a>Hign-Level Overview (é«˜å±‚æ€»è§ˆ)</h2><p>At the highest conceptual level, Shiroâ€™s architecture has 3 primary concepts: the <code>Subject</code>, <code>SecurityManager</code> and <code>Realms</code>. The following diagram is a high-level overview of how these components interact, and weâ€™ll cover each concept below:</p>
<p>åœ¨æœ€é¡¶å±‚çš„æ¦‚å¿µå±‚ä¸­ï¼ŒShiro æ¶æ„æœ‰ä¸‰ä¸ªä¸»è¦æ¦‚å¿µ:<code>Subject</code>,<code>SecurityManager</code>å’Œ<code>Realms</code>,ä¸‹å›¾å°±æ˜¯è¿™äº›ç»„ä»¶å¦‚ä½•äº¤äº’çš„ä¸€ä¸ªæ¦‚å¿µå±‚æ€»è§ˆã€‚æˆ‘ä»¬ä¼šåœ¨ä¸‹é¢é˜è¿°å„ä¸ªæ¦‚å¿µ</p>
<p><img src="/sunshine-carroll.github.io/2020/02/29/Shiro-Architecture/ShiroBasicArchitecture.png" alt="ShiroBasicArchitecture"></p>
<hr>
<blockquote>
<ul>
<li><p><strong>Subject</strong>: As weâ€™ve mentioned in our <a href="http://shiro.apache.org/tutorial.html" target="_blank" rel="noopener">Tutorial</a>, the <code>Subject</code> is essentially a security specific â€˜viewâ€™ of the the currently executing user. Whereas the word â€˜Userâ€™ often implies a human being, a <code>Subject</code> can be a person, but it could also represent a 3rd-party service, daemon account, cron job, or anything similar - basically anything that is currently interacting with the software.</p>
<p><code>Subject</code> instances are all bound to (and require) a <code>SecurityManager</code>. When you interact with a <code>Subject</code>, those interactions translate to subject-specific interactions with the <code>SecurityManager</code>.</p>
</li>
<li><p><strong>Subject</strong>: å°±åƒæˆ‘ä»¬åœ¨æ•™ç¨‹ä¸­æåˆ°çš„ï¼Œ<code>Subject</code>æœ¬è´¨ä¸Šå°±æ˜¯å½“å‰æ‰§è¡Œç”¨æˆ·çš„åœ¨å®‰å…¨é¢†åŸŸä¸Šä¸€ä¸ªç‰¹å®šçš„è§†è§’ï¼Œç„¶è€Œâ€ç”¨æˆ·â€ä¸€è¯é€šå¸¸æš—æŒ‡äººç±»ï¼Œä¸€ä¸ª<code>Subject</code>å¯ä»¥æ˜¯ä¸€ä¸ªäººï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œå®ˆæŠ¤è¿›ç¨‹è´¦æˆ·ï¼Œå®šæ—¶ä»»åŠ¡æˆ–è€…ä»»æ„ç›¸ä¼¼çš„ä¸å½“å‰è½¯ä»¶äº¤äº’çš„äº‹ç‰©</p>
<p><code>Subject</code>å®ä¾‹éƒ½å’Œä¸€ä¸ª<code>SecurityManager</code>ç»‘å®šã€‚å½“ä½ å’Œä¸€ä¸ª<code>Subject</code>äº¤äº’æ—¶ï¼Œè¿™äº›äº¤äº’å°±è½¬åŒ–ä¸ºsubject-specific ä¸<code>SecurityManager</code>äº¤äº’</p>
</li>
<li><p><strong>SecurityManager</strong>: The <code>SecurityManager</code> is the heart of Shiroâ€™s architecture and acts as a sort of â€™umbrellaâ€™ object that coordinates its internal security components that together form an object graph. However, once the SecurityManager and its internal object graph is configured for an application, it is usually left alone and application developers spend almost all of their time with the <code>Subject</code> API.</p>
<p>We will talk about the <code>SecurityManager</code> in detail later on, but it is important to realize that when you interact with a <code>Subject</code>, it is really the <code>SecurityManager</code> behind the scenes that does all the heavy lifting for any <code>Subject</code> security operation. This is reflected in the basic flow diagram above.</p>
</li>
<li><p><strong>SecurityManager</strong>: <code>SecurityManager</code> æ˜¯Shiroæ¡†æ¶çš„æ ¸å¿ƒå¹¶æ‰®æ¼”åƒæ˜¯ä¸€ä¸ªåè°ƒå†…éƒ¨ç»„åˆæˆä¸€å‰¯å¯¹è±¡å›¾æ™¯çš„å®‰å…¨ç»„ä»¶çš„â€ä¿æŠ¤ä¼â€è§’è‰²ã€‚ ä¸ç®¡æ€æ ·ï¼Œå½“<code>SecurityManager</code>å’Œå…¶å†…éƒ¨çš„å¯¹è±¡å›¾æ™¯é…ç½®å®Œæˆå,é€šå¸¸å¯ä»¥ä¸ç®¡ä»– ï¼Œåº”ç”¨ç¨‹åºå¼€å‘å¤§éƒ¨åˆ†æ—¶å€™éƒ½èŠ±åœ¨å’Œ<code>Subject</code> çš„äº¤äº’ä¸Šã€‚</p>
<p>æˆ‘ä»¬ç¨åä¼šè®¨è®º<code>SecurityManager</code>çš„ç»†èŠ‚ï¼Œä½†æ˜¯ï¼Œå½“ä½ å’Œ<code>Subject</code>äº¤äº’çš„æ—¶å€™ï¼Œæ„è¯†åˆ°åœ¨å¹•å<code>SecurityManager</code> ä¸ºä»»äººä¸€ä¸ª<code>Subject</code>çš„å®‰å…¨æ“ä½œåšäº†æ‰€æœ‰çš„è‰°éš¾æ“ä½œ.è¿™ä¹Ÿååº”åœ¨ä¸Šé¢çš„åŸºæœ¬æµç¨‹å›¾ä¸Šã€‚</p>
</li>
<li><p><strong>Realms</strong>: Realms act as the â€˜bridgeâ€™ or â€˜connectorâ€™ between Shiro and your applicationâ€™s security data. When it comes time to actually interact with security-related data like user accounts to perform authentication (login) and authorization (access control), Shiro looks up many of these things from one or more Realms configured for an application.</p>
<p>In this sense a Realm is essentially a security-specific <a href="https://en.wikipedia.org/wiki/Data_access_object" target="_blank" rel="noopener">DAO</a>: it encapsulates connection details for data sources and makes the associated data available to Shiro as needed. When configuring Shiro, you must specify at least one Realm to use for authentication and/or authorization. The <code>SecurityManager</code>may be configured with multiple Realms, but at least one is required.</p>
<p>Shiro provides out-of-the-box Realms to connect to a number of security data sources (aka directories) such as LDAP, relational databases (JDBC), text configuration sources like INI and properties files, and more. You can plug-in your own Realm implementations to represent custom data sources if the default Realms do not meet your needs.</p>
<p>Like other internal components, the Shiro <code>SecurityManager</code> manages how Realms are used to acquire security and identity data to be represented as <code>Subject</code> instances.</p>
</li>
<li><p><strong>Realms</strong>: Realms æ‰®æ¼”è€…Shiro å’Œ ä½ çš„åº”ç”¨ç¨‹åºçš„å®‰å…¨æ•°æ®ä¹‹é—´çš„â€™æ¡¥æ¢â€™æˆ–è€…è¯´â€™è¿æ¥å™¨â€™çš„è§’è‰²ã€‚å½“åˆ°Shrioè¿è¡Œåˆ°ä¸å®‰å…¨ç›¸å…³çš„æ•°æ®äº¤äº’çš„æ—¶å€™ï¼Œå¦‚ç”¨æˆ·è´¦æˆ·å»æ‰§è¡Œ è®¤è¯(ç™»å½•)ï¼Œæˆæƒ(è®¿é—®æ§åˆ¶)ï¼Œ Shiro ä»åº”ç”¨ç¨‹åºé…ç½®å¥½çš„ä¸€ä¸ªæˆ–å¤šä¸ªRealmä¸­æœå¯»è¿™äº›æ•°æ®</p>
<p>ä»è¿™ä¸ªè§’åº¦ï¼ŒRealm æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç‰¹å®šçš„å®‰å…¨DAO(Data Access Object):ä»–å°è£…å’Œæ•°æ®æºè¿æ¥çš„ç»†èŠ‚ï¼Œå¹¶ä¸”ä½¿å¾—ç›¸å…³çš„æ•°æ®æŒ‰Shiroæ‰€éœ€çš„æ–¹å¼è¢«Shiroä½¿ç”¨ã€‚å½“é…ç½®Shiroæ—¶ï¼Œä½ å¿…é¡»è‡³å°‘æŒ‡å®šä¸€ä¸ªç”¨æˆ·è®¤è¯å’Œï¼ˆæˆ–ï¼‰æˆæƒçš„Relamã€‚<code>SecurityManager</code>å¯èƒ½ä¼šé…ç½®å¤šä¸ªé¢†åŸŸï¼Œä½†è‡³å°‘éœ€è¦ä¸€ä¸ª</p>
<p>Shiro æä¾›ä¸€äº›å¼€ç®±å³ç”¨çš„Realmå»å’Œä¸€äº›å®‰å…¨æ•°æ®æºå»ºç«‹è¿æ¥ï¼Œæ¯”å¦‚è¯´LDAP(è½»é‡çº§ç›®å½•è®¿é—®åè®®)ï¼Œå…³ç³»å‹æ•°æ®åº“(JDBC)ï¼Œæ–‡æœ¬é…ç½®æºå¦‚iniå’Œå±æ€§æ–‡ä»¶ç­‰ç­‰ã€‚å¦‚æœé»˜è®¤çš„Realmsä¸æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½ å¯ä»¥æ’å…¥ä½ è‡ªå·±çš„é¢†åŸŸå®ç°å»è¡¨ç¤ºè‡ªå®šä¹‰çš„æ•°æ®æº</p>
<p>å°±åƒå…¶ä»–çš„å†…éƒ¨ç»„ä»¶,Shiroçš„ <code>SecurityManager</code>ç®¡ç†ç€å¦‚ä½•å°† Realms è·å–å®‰å…¨å’Œèº«ä»½æ•°æ®çš„è¡¨ç¤ºä¸º<code>Subject</code>å®ä¾‹</p>
</li>
</ul>
</blockquote>
<hr>
<h2 id="Detailed-Architecture-è¯¦ç»†çš„æ¶æ„"><a href="#Detailed-Architecture-è¯¦ç»†çš„æ¶æ„" class="headerlink" title="Detailed Architecture(è¯¦ç»†çš„æ¶æ„)"></a><a href="http://shiro.apache.org/architecture.html#detailed-architecture" target="_blank" rel="noopener">Detailed Architecture</a>(è¯¦ç»†çš„æ¶æ„)</h2><p>The following diagram shows Shiroâ€™s core architectural concepts followed by short summaries of each:</p>
<p>ä¸‹é¢å±•ç¤ºäº†Shiroçš„æ ¸å¿ƒæ¶æ„æ¦‚å¿µï¼Œå¹¶ä¸ºæ¯ä¸€ä¸ªæ¦‚å¿µæœ‰ä¸€ä¸ªç®€çŸ­çš„æ€»ç»“</p>
<p><img src="/sunshine-carroll.github.io/2020/02/29/Shiro-Architecture/ShiroArchitecture.png" alt="ShiroArchitecture"></p>
<blockquote>
<ul>
<li><p><strong>Subject</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/subject/Subject.html" target="_blank" rel="noopener"><code>org.apache.shiro.subject.Subject</code></a>)<br>A security-specific â€˜viewâ€™ of the entity (user, 3rd-party service, cron job, etc) currently interacting with the software.</p>
</li>
<li><p><strong>Subject</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/subject/Subject.html" target="_blank" rel="noopener"><code>org.apache.shiro.subject.Subject</code></a>)</p>
<p>å½“å‰ä¸è½¯ä»¶äº¤äº’çš„å®ä½“(ç”¨æˆ·ï¼Œç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œå®šæ—¶ä»»åŠ¡ç­‰ç­‰)çš„ä¸€ä¸ªç‰¹å®šçš„å®‰å…¨â€™è§†å›¾â€™</p>
</li>
<li><p><strong>SecurityManager</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/mgt/SecurityManager.html" target="_blank" rel="noopener">org.apache.shiro.mgt.SecurityManager</a>)<br>As mentioned above, the <code>SecurityManager</code> is the heart of Shiroâ€™s architecture. It is mostly an â€˜umbrellaâ€™ object that coordinates its managed components to ensure they work smoothly together. It also manages Shiroâ€™s view of every application user, so it knows how to perform security operations per user.</p>
</li>
<li><p><strong>SecurityManager</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/mgt/SecurityManager.html" target="_blank" rel="noopener">org.apache.shiro.mgt.SecurityManager</a>)</p>
<p>å¦‚ä¸Šæ‰€è¿°ï¼Œ<code>SecurityManager</code>æ—¶Shiroæ¶æ„çš„æ ¸å¿ƒ.é€šå¸¸æ˜¯åè°ƒå—ç®¡ç»„ä»¶ï¼Œç¡®ä¿ä»–ä»¬ä¸€èµ·å¹³ç¨³çš„å·¥ä½œçš„â€™ä¿æŠ¤ä¼â€™,ä»–ç®¡ç†ç€æ¯ä¸€ä¸ªåº”ç”¨ç¨‹åºç”¨æˆ·çš„è§†å›¾ï¼Œå› æ­¤ä»–çŸ¥é“å¦‚ä½•ä¸ºæ¯ä¸€ä¸ªç”¨æˆ·æ‰§è¡Œå®‰å…¨çš„æ“ä½œ</p>
</li>
<li><p><strong>Authenticator</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/authc/Authenticator.html" target="_blank" rel="noopener">org.apache.shiro.authc.Authenticator</a>)<br>The <code>Authenticator</code> is the component that is responsible for executing and reacting to authentication (log-in) attempts by users. When a user tries to log-in, that logic is executed by the <code>Authenticator</code>. The <code>Authenticator</code> knows how to coordinate with one or more <code>Realms</code> that store relevant user/account information. The data obtained from these <code>Realms</code> is used to verify the userâ€™s identity to guarantee the user really is who they say they are.</p>
</li>
<li><p><strong>Authenticator</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/authc/Authenticator.html" target="_blank" rel="noopener">org.apache.shiro.authc.Authenticator</a>)</p>
<p><code>Authenticator</code>æ˜¯ä»¥æ‰§è¡Œå’Œååº”ç”¨æˆ·çš„è®¤è¯ï¼ˆç™»å½•ï¼‰ä¸ºèŒè´£çš„ç»„ä»¶ã€‚å½“ä¸€ä¸ªç”¨æˆ·è¯•å›¾ç™»å½•æ—¶ï¼Œè¿™ä¸ªé€»è¾‘å°±è¢«<code>Authenticator</code>æ‰§è¡Œã€‚<code>Authenticator</code>çŸ¥é“å¦‚ä½•ä¸å­˜å‚¨è€…ç”¨æˆ·/è´¦æˆ·ä¿¡æ¯çš„ä¸€ä¸ªæˆ–å¤šä¸ª<code>Realm</code>åä½œã€‚ç”±è¿™äº›<code>Realms</code>ç»´æŠ¤çš„æ•°æ®ç”¨äºéªŒè¯ç”¨æˆ·çš„èº«ä»½ï¼Œä¿è¯ç”¨æˆ·çš„ç¡®æ˜¯ä»–ä»¬æ‰€è¯´çš„é‚£ä¸€ä¸ª</p>
</li>
<li><p><strong>Authorizer</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/authz/Authorizer.html" target="_blank" rel="noopener">org.apache.shiro.authz.Authorizer</a>)<br>The <code>Authorizer</code> is the component responsible determining usersâ€™ access control in the application. It is the mechanism that ultimately says if a user is allowed to do something or not. Like the <code>Authenticator</code>, the <code>Authorizer</code> also knows how to coordinate with multiple back-end data sources to access role and permission information. The <code>Authorizer</code> uses this information to determine exactly if a user is allowed to perform a given action.</p>
</li>
<li><p><code>Authorizer</code>æ˜¯å¯¹ç¡®å®šåº”ç”¨ç¨‹åºä¸­ç”¨æˆ·çš„è®¿é—®æ§åˆ¶è´Ÿè´£çš„ç»„ä»¶ã€‚è¿™ä¸ªæœºåˆ¶æœ€ç»ˆåˆ¤æ–­ä¸€ä¸ªç”¨æˆ·å…è®¸æˆ–ä¸å…è®¸åšä¸€äº›äº‹ã€‚å°±åƒ<code>Authenticator</code>ï¼Œ<code>Authorizer</code> çŸ¥é“å¦‚ä½•ä½¿ç”¨å¤šä¸ªåå°æ•°æ®æºä¼ä¸šè®¿é—®è§’è‰²å’Œæƒé™ä¿¡æ¯ã€‚<code>Authorizer</code>ä½¿ç”¨è¿™äº›æ•°æ®å»æ­£ç¡®çš„ç¡®å®šä¸€ä¸ªç”¨æˆ·æ˜¯å¦å…è®¸æ‰§è¡Œä¸€ä¸ªç»™å®šçš„è¡Œä¸º</p>
</li>
<li><p><strong>SessionManager</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/session/mgt/SessionManager.html" target="_blank" rel="noopener">org.apache.shiro.session.mgt.SessionManager</a>)<br>The <code>SessionManager</code> knows how to create and manage user <code>Session</code> lifecycles to provide a robust Session experience for users in all environments. This is a unique feature in the world of security frameworks - Shiro has the ability to natively manage user Sessions in any environment, even if there is no Web/Servlet or EJB container available. By default, Shiro will use an existing session mechanism if available, (e.g. Servlet Container), but if there isnâ€™t one, such as in a standalone application or non-web environment, it will use its built-in enterprise session management to offer the same programming experience. The <code>SessionDAO</code> exists to allow any datasource to be used to persist sessions.</p>
</li>
<li><p><code>SessionManager</code>çŸ¥é“å¦‚ä½•åˆ›å»ºå’Œç®¡ç†ç”¨æˆ·<code>Session</code>çš„ç”Ÿå‘½å‘¨æœŸå¹¶åœ¨ä»»ä½•ç¯å¢ƒä¸‹æä¾›ç»™ç”¨æˆ·ä¸€ä¸ªå¥å£®çš„ä¼šè¯ä½“éªŒã€‚åœ¨å®‰å…¨æ¡†æ¶çš„ä¸–ç•Œä¸­è¿™æ˜¯ä¸ªç‹¬ç‰¹çš„ç‰¹æ€§â€”å³ä½¿ä¸åœ¨Web/Servletæˆ–EJBå®¹å™¨ä¸­ï¼ŒShiroå¤©ç„¶çš„æœ‰åœ¨ä»»ä½•ç¯å¢ƒä¸‹ç®¡ç†ç”¨æˆ·ä¼šè¯çš„èƒ½åŠ›ã€‚å¦‚æœæœ‰å¯ä»¥ä½¿ç”¨çš„ä¼šè¯æœºåˆ¶(å¦‚Servlet Container)ï¼ŒShiroé»˜è®¤ä¼šä½¿ç”¨å®ƒ,ä½†æ˜¯å¦‚æœæ²¡æœ‰ï¼Œå°±åƒç‹¬ç«‹çš„åº”ç”¨ç¨‹åºæˆ–éwebç¯å¢ƒä¸‹ï¼Œä»–ä¼šä½¿ç”¨ä»–å†…å»ºçš„ä¼ä¸šçº§ä¼šè¯ç®¡ç†ä»¥æä¾›ç›¸åŒçš„ç¼–ç¨‹ä½“éªŒã€‚<code>SessionDAO</code>ä¸ºå…è®¸ä»»ä½•ç”¨äºæŒä¹…åŒ–ä¼šè¯çš„æ•°æ®æºè€Œå­˜åœ¨</p>
</li>
<li><p><strong>CacheManager</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/cache/CacheManager.html" target="_blank" rel="noopener">org.apache.shiro.cache.CacheManager</a>)<br>The <code>CacheManager</code> creates and manages <code>Cache</code> instance lifecycles used by other Shiro components. Because Shiro can access many back-end data sources for authentication, authorization and session management, caching has always been a first-class  feature in the framework to improve performance while using these data sources. Any of the modern open-source and/or enterprise caching products can be plugged in to Shiro to provide a fast and efficient user-experience.</p>
</li>
<li><p><strong>CacheManager</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/cache/CacheManager.html" target="_blank" rel="noopener">org.apache.shiro.cache.CacheManager</a>)</p>
<p><code>CacheManager</code>åˆ›å»ºå’Œç®¡ç†è¢«å…¶ä»–Shiroç»„ä»¶ä½¿ç”¨çš„ç¼“å­˜å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸã€‚ç”±äºShiro èƒ½å¤Ÿè®¿é—®è®¸å¤šç”¨æˆ·è®¤è¯ï¼Œæˆæƒå’Œä¼šè¯ç®¡ç†çš„åå°æ•°æ®ï¼Œåœ¨æ¡†æ¶ä¸­ç¼“å­˜é€šå¸¸æ˜¯åœ¨ä½¿ç”¨è¿™äº›æ•°æ®æºæ—¶æé«˜æ€§èƒ½çš„ä¸€ä¸ªä¼˜ç§€çš„ç‰¹æ€§ã€‚ä»»ä½•ä¸€ä¸ªç°ä»£çš„å¼€æºå’Œï¼ˆæˆ–ï¼‰ä¼ä¸šçº§ç¼“å­˜äº§å“èƒ½å¤ŸåµŒå…¥åˆ°Shiroä¸­ä»¥æé«˜å¿«ä¸”é«˜æ•ˆçš„ç”¨æˆ·ä½“éªŒ</p>
</li>
<li><p><strong>Cryptography</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/crypto/package-summary.html" target="_blank" rel="noopener">org.apache.shiro.crypto.*</a>)<br>Cryptography is a natural addition to an enterprise security framework. Shiroâ€™s <code>crypto</code> package contains easy-to-use and understand representations of crytographic Ciphers, Hashes (aka digests) and different codec implementations. All of the classes in this package are carefully designed to be very easy to use and easy to understand. Anyone who has used Javaâ€™s native cryptography support knows it can be a challenging animal to tame. Shiroâ€™s crypto APIs simplify the complicated Java mechanisms and make cryptography easy to use for normal mortal human beings.</p>
</li>
<li><p>å¯¹äºä¸€ä¸ªä¼ä¸šçº§å®‰å…¨æ¡†æ¶ï¼ŒåŠ å¯†æ˜¯ä¸€ä¸ªè‡ªç„¶è€Œç„¶çš„åŠŸèƒ½ã€‚Shiro çš„<code>crypto</code>åŒ…å«æ˜“äºä½¿ç”¨å’Œç†è§£çš„å¯†ç å­¦ä¸Šçš„åŠ å¯†å·¥å…·ï¼Œå“ˆå¸Œ(ä¼—æ‰€å‘¨çŸ¥çš„ä¿¡æ¯æ‘˜è¦ç®—æ³• ),å’Œä¸åŒçš„ç¼–ç è§£ç å™¨å®ç°.åœ¨è¿™ä¸ªåŒ…ä¸­çš„æ‰€æœ‰ç±»ï¼Œéƒ½ä¸ºæ˜“äºç†è§£å’Œä½¿ç”¨è€Œè®¾è®¡ã€‚ä»»ä½•ä¸€ä¸ªç”¨è¿‡JavaåŸç”Ÿçš„åŠ å¯†æ”¯æŒçš„äººéƒ½çŸ¥é“,it can be a challenging animal to tameã€‚Shiroçš„crypto API ç®€åŒ–è¿™äº›å¤æ‚çš„Javaæœºåˆ¶å¹¶ä¸”è®©åŠ å¯†åŠŸèƒ½å¯¹æ­£å¸¸çš„æ™®é€šäººæ¥è¯´ä½¿ç”¨ç®€å•ã€‚</p>
</li>
<li><p><strong>Realms</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/realm/Realm.html" target="_blank" rel="noopener">org.apache.shiro.realm.Realm</a>)<br>As mentioned above, Realms act as the â€˜bridgeâ€™ or â€˜connectorâ€™ between Shiro and your applicationâ€™s security data. When it comes time to actually interact with security-related data like user accounts to perform authentication (login) and authorization (access control), Shiro looks up many of these things from one or more Realms configured for an application. You can configure as many <code>Realms</code> as you need (usually one per data source) and Shiro will coordinate with them as necessary for both authentication and authorization.</p>
</li>
<li><p><strong>Realms</strong> (<a href="http://shiro.apache.org/static/current/apidocs/org/apache/shiro/realm/Realm.html" target="_blank" rel="noopener">org.apache.shiro.realm.Realm</a>)</p>
<p>å¦‚ä¸Šæ‰€è¿°ï¼ŒRealm æ‰®æ¼”çš„Shiroå’Œä½ åº”ç”¨ç¨‹åºçš„å®‰å…¨æ•°æ®çš„â€™æ¡¥æ¢â€™æˆ–â€™è¿æ¥å™¨â€™ã€‚å½“åˆ°Shrioè¿è¡Œåˆ°ä¸å®‰å…¨ç›¸å…³çš„æ•°æ®äº¤äº’çš„æ—¶å€™ï¼Œå¦‚ç”¨æˆ·è´¦æˆ·å»æ‰§è¡Œ è®¤è¯(ç™»å½•)ï¼Œæˆæƒ(è®¿é—®æ§åˆ¶)ï¼Œ Shiro ä»åº”ç”¨ç¨‹åºé…ç½®å¥½çš„ä¸€ä¸ªæˆ–å¤šä¸ªRealmä¸­æœå¯»è¿™äº›æ•°æ®ã€‚ä½ å¯ä»¥æŒ‰ä½ çš„éœ€è¦çš„Realmæ•°æ¥é…ç½®Realm(é€šå¸¸æ¯ä¸ªæ•°æ®æºä¸€ä¸ªRealm)å¹¶ä¸”Shiroä¼šæŒ‰éœ€ä¸ºè®¤è¯å’Œæˆæƒåè°ƒä»–ä»¬</p>
</li>
</ul>
</blockquote>
<hr>
<h2 id="The-SecurityManager"><a href="#The-SecurityManager" class="headerlink" title="The SecurityManager"></a>The <code>SecurityManager</code></h2><p>Because Shiroâ€™s API encourages a <code>Subject</code>-centric programming approach, most application developers will rarely, if ever, interact with the <code>SecurityManager</code>directly (framework developers however  sometimes find it useful). Even so, it is still important to know how the <code>SecurityManager</code> functions, especially when configuring one for an application.</p>
<p>ç”±äº Shiro çš„APIé¼“åŠ±ä¸€ä¸ªä»¥<code>Subject</code>ä¸ºä¸­å¿ƒçš„ç¼–ç¨‹æ–¹å¼ï¼Œå¤§å¤šæ•°åº”ç”¨ç¨‹åºå¼€å‘è€…å°†å¾ˆå°‘çš„ï¼Œä¸<code>SecurityManager</code>äº¤äº’(æ¡†æ¶å¼€å‘è€…å´æœ‰æ—¶è®¤ä¸ºè¿™æ˜¯éå¸¸æœ‰ç”¨çš„)ã€‚å³ä½¿å¦‚æ­¤ï¼ŒçŸ¥é“<code>SecurityManager</code>çš„åŠŸèƒ½ä¾æ—§æ˜¯é‡è¦çš„,å°¤å…¶æ˜¯åœ¨é…ç½®ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„æ—¶å€™</p>
<h2 id="Design"><a href="#Design" class="headerlink" title="Design"></a><a href="http://shiro.apache.org/architecture.html#design" target="_blank" rel="noopener">Design</a></h2><p>As stated previously, the applicationâ€™s <code>SecurityManager</code> performs security operations and manages state for <em>all</em> application users. In Shiroâ€™s default <code>SecurityManager</code> implementations, this includes:</p>
<p>å¦‚å‰æ‰€è¿°,åº”ç”¨ç¨‹åºçš„<code>SecurityManager</code>æ‰§è¡Œå®‰å…¨æ“ä½œå¹¶ä¸”ä¸ºæ‰€æœ‰åº”ç”¨ç¨‹åºç”¨æˆ·ç®¡ç†çŠ¶æ€ã€‚åœ¨Shiroé»˜è®¤çš„<code>SecurityManager</code>å®ç°ä¸­ä»–åŒ…å«:</p>
<ul>
<li>Authentication  è®¤è¯</li>
<li>Authorization  æˆæƒ</li>
<li>Session Management ä¼šè¯ç®¡ç†</li>
<li>Cache Management ç¼“å­˜ç®¡ç†</li>
<li><a href="http://shiro.apache.org/realm.html" target="_blank" rel="noopener">Realm</a> coordination é¢†åŸŸåä½œ</li>
<li>Event propagation äº‹ä»¶ä¼ é€’</li>
<li>â€œRemember Meâ€ Services â€˜è®°ä½æˆ‘â€™ æœåŠ¡</li>
<li>Subject creation åˆ›å»ºSubject</li>
<li>Logout and more. ç™»å‡º ç­‰ç­‰</li>
</ul>
<p>But this is a lot of functionality to try to manage in a single component. And, making these things flexible and customizable would be very difficult if everything were lumped into a single implementation class.</p>
<p>ä½†æ˜¯æœ‰å¤§é‡çš„åŠŸèƒ½å°è¯•æ”¾åœ¨å•ä¸ªç»„ä»¶ä¸­ã€‚å¹¶ä¸”ï¼Œå¦‚æœæŠŠæ‰€æœ‰çš„ä¸œè¥¿é›†ä¸­åœ¨å•ä¸ªå®ç°ç±»ä¸­ï¼Œè®©è¿™äº›åŠŸèƒ½å˜å¾—çµæ´»å’Œå¯è‡ªå®šä¹‰å°†ä¼šå˜å¾—éå¸¸å›°éš¾ã€‚</p>
<p>To simplify configuration and enable flexible configuration/pluggability, Shiroâ€™s implementations are all highly modular in design - so modular in fact, that the SecurityManager implementation (and its class-hierarchy) does not do much at all. Instead, the <code>SecurityManager</code> implementations mostly act as a lightweight â€˜containerâ€™ component, delegating almost all behavior to nested/wrapped components. This â€˜wrapperâ€™ design is reflected in the detailed architecture diagram above.</p>
<p>ä¸ºäº†ç®€åŒ–é…ç½®å¹¶èƒ½å¤Ÿçµæ´»çš„é…ç½®åŒ–/æ’ä»¶åŒ–ï¼ŒShiroçš„å®ç°åœ¨è®¾è®¡ä¸Šéƒ½é«˜åº¦çš„æ¨¡å—åŒ–ã€‚äº‹å®ä¸Šç”±äºå¦‚æ­¤çš„æ¨¡å—åŒ–ï¼Œ<code>SecurityManager</code> çš„å®ç°(å’Œä»–çš„ç±»å±‚æ¬¡ç»“æ„)æ²¡æœ‰åšå¤ªå¤šçš„äº‹æƒ…ã€‚åè€Œ,<code>SecurityManager</code>çš„å®ç°æ‰®æ¼”è€…è½»é‡çº§â€™å®¹å™¨â€™ç»„ä»¶,å°†å¤§éƒ¨åˆ†è¡Œä¸ºå§”æ‰˜ç»™å†…åµŒçš„/åŒ…è£…çš„çš„ç»„ä»¶.è¿™ä¸ªâ€™åŒ…è£…å™¨â€™çš„è®¾è®¡ååº”åœ¨ä¸Šé¢çš„detailed architectureå›¾ä¸­</p>
<p>While the components actually execute the logic, the <code>SecurityManager</code> implementation knows how and when to coordinate the components for the correct behavior.</p>
<p>å½“ç»„ä»¶å®é™…æ‰§è¡Œé€»è¾‘æ—¶ï¼Œ<code>SecurityManager</code>çŸ¥é“å¦‚ä½•ä»¥åŠä½•æ—¶åè°ƒè¿™äº›ç»„ä»¶æ¥è¡¨ç°æ­£ç¡®çš„è¡Œä¸º</p>
<p>The <code>SecurityManager</code> implementations and the components are also JavaBeans compatible, which allows you (or a configuration mechanism) to easily customize the pluggable components via standard JavaBeans accessor/mutator methods (get<em>/set</em>). This means the Shiroâ€™s architectural modularity can translate into very easy configuration for custom behavior.</p>
<p><code>SecurityManager</code>çš„å®ç°å’Œç»„ä»¶éƒ½æ˜¯JavaBeanså…¼å®¹çš„,èƒ½å¤Ÿå…è®¸ä½ (æˆ–å…¶ä»–é…ç½®æœºåˆ¶)é€šè¿‡æ ‡å‡†JavaBeansçš„è®¿é—®å™¨/ä¿®æ”¹å™¨æ–¹æ³•(get/set)æ¥ç®€æ´çš„è‡ªå®šä¹‰è¿™äº›å¯æ’å…¥çš„ç»„ä»¶ã€‚è¿™æ„å‘³ç€ Shiroçš„æ¶æ„æ¨¡å—èƒ½å¦å˜åŒ–éå¸¸ç®€æ˜“çš„é…ç½®æ¥è‡ªå®šä¹‰è¡Œä¸ºã€‚</p>

                
                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/sunshine-carroll.github.io/2020/07/24/spring-resources/" data-toggle="tooltip" data-placement="top" title="spring-resources">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/sunshine-carroll.github.io/2020/02/26/ç”µå­ä¹¦é€šé“/" data-toggle="tooltip" data-placement="top" title="ç”µå­ä¹¦é€šé“">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- tip start -->
                

                
                <div class="comment_notes">
                    <p>
                        This is copyright.
                    </p>
                </div>
                
                <!-- tip end -->

                <!-- Music start-->
                
                <!-- Music end -->

                <!-- Sharing -->
                
                <div class="social-share"  data-wechat-qrcode-helper="" align="center"></div>
                <!--  css & js -->
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
                <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
                
                <!-- Sharing -->

                <!-- gitment start -->
                
                <hr>
                <div id="blog_comments"></div>

<!--
<script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/default.css"/>
-->
<!--
<link rel="stylesheet" href="/css/gitment.css">
<script type="text/javascript" src="/js/gitment.js"></script>
-->

<script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/default.css"/>

<!--
<link rel="stylesheet" href="https://billts.site/extra_css/gitment.css">
<script src="https://billts.site/js/gitment.js"></script>
-->

<script>
const myTheme = {
  render(state, instance) {
    const container = document.createElement('div')
    container.lang = "en-US"
    container.className = 'gitment-container gitment-root-container'
    
     // your custom component
    container.appendChild(instance.renderSomething(state, instance))
    
    container.appendChild(instance.renderHeader(state, instance))
    container.appendChild(instance.renderComments(state, instance))
    container.appendChild(instance.renderEditor(state, instance))
    //container.appendChild(instance.renderFooter(state, instance))
    return container
  },
  renderSomething(state, instance) {
    const container = document.createElement('div')
    container.lang = "en-US"
    container.className = 'hello_visitor'
    if (state.user.login) {
      container.innerText = `Hello ${state.user.login}, Welcome to comment system`
    }
    return container
  }
}


const gitment = new Gitment({
    id: 'Sat Feb 29 2020 19:36:04 GMT+0800', // optional
    owner: "sunshine-carroll",
    repo: "sunshine-carroll.github.io",
    oauth: {
      client_id: "8895df271bbbcbad4ed1",
      client_secret: "ccc414232347145b6ca3d9af201ee7d42446aba6",
    },
    theme: myTheme,
    // ...
    // For more available options, check out the documentation below
  })
  
  gitment.render('blog_comments')
  // or
  // gitment.render(document.getElementById('comments'))
  // or
  // document.body.appendChild(gitment.render())
</script>
                
                <!-- gitment end -->

                <!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
                
                <hr>
                <div id="lv-container" data-id="city" data-uid="MTAyMC80NzQ3MS8yMzk3MQ==">
                    <script type="text/javascript">
                   (function(d, s) {
                       var j, e = d.getElementsByTagName(s)[0];

                       if (typeof LivereTower === 'function') { return; }

                       j = d.createElement(s);
                       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                       j.async = true;

                       e.parentNode.insertBefore(j, e);
                   })(document, 'script');
                    </script>
                <noscript> ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
                </div>
                
                <!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->

                <!-- disqus comment start -->
                
                <div class="comment">
                    <div id="disqus_thread" class="disqus-thread"></div>
                </div>
                
                <!-- disqus comment end -->
            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      
        <aside id="sidebar">
          <div id="toc" class="toc-article">
          <strong class="toc-title">Contents</strong>
          
            
              <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Apache-Shiro-Architecture-ï¼ˆApache-Shiro-æ¶æ„"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">Apache Shiro Architecture ï¼ˆApache Shiro æ¶æ„)</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Hign-Level-Overview-é«˜å±‚æ€»è§ˆ"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">Hign-Level Overview (é«˜å±‚æ€»è§ˆ)</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Detailed-Architecture-è¯¦ç»†çš„æ¶æ„"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">Detailed Architecture(è¯¦ç»†çš„æ¶æ„)</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#The-SecurityManager"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">The SecurityManager</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Design"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">Design</span></a></li></ol>
            
          
          </div>
        </aside>
      
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/sunshine-carroll.github.io/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/sunshine-carroll.github.io/tags/#Shiro" title="Shiro">Shiro</a>
                        
                          <a class="tag" href="/sunshine-carroll.github.io/tags/#work" title="work">work</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://sunshine-carroll.github.io" target="_blank">Sunshine&#39;s Blog</a></li>
                    
                        <li><a href="#" target="_blank">Sunshine&#39;s Web</a></li>
                    
                        <li><a href="https://github.com/sunshine-carroll" target="_blank">Sunshine&#39;s Github</a></li>
                    
                        <li><a href="#" target="_blank">Other</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>


<!-- disqus embedded js code start (one page only need to embed once) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "sunshine-carroll";
    var disqus_identifier = "https://sunshine-carroll.github.io/2020/02/29/Shiro-Architecture/";
    var disqus_url = "https://sunshine-carroll.github.io/2020/02/29/Shiro-Architecture/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus embedded js code start end -->



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'â„¬'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>


<style  type="text/css">
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">

                
                    <li>
                        <a target="_blank"  href="https://github.com/sunshine-carroll">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="https://twitter.com/dusignr">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="https://www.facebook.com/Gang Du">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/dusignr">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">çŸ¥</i>
                            </span>
                        </a>
                    </li>
                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; sunshine 2020 
                    <br>
                    Powered by 
                    <a href="https://github.com/dusign/hexo-theme-snail" target="_blank" rel="noopener">
                        <i>hexo-theme-snail</i>
                    </a> | 
                    <iframe name="star" style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0"
                        width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=dusign&repo=hexo-theme-snail&type=star&count=true">
                    </iframe>
                </p>
            </div>
        </div>
    </div>

</footer>

<!-- jQuery -->

<script src="/sunshine-carroll.github.io/js/jquery.min.js"></script>


<!-- Bootstrap Core JavaScript -->

<script src="/sunshine-carroll.github.io/js/bootstrap.min.js"></script>


<!-- Custom Theme JavaScript -->

<script src="/sunshine-carroll.github.io/js/hux-blog.min.js"></script>


<!-- Search -->

<script src="/sunshine-carroll.github.io/js/search.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://sunshine-carroll.github.io/sunshine-carroll.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->


<!-- Search -->

    <script type="text/javascript">      
        var search_path = "search.xml";
        if (search_path.length == 0) {
            search_path = "search.xml";
        }
    var path = "/sunshine-carroll.github.io/" + search_path;
    searchFunc(path, 'local-search-input', 'local-search-result');
    </script>


<!-- busuanzi -->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>

    
        <!-- background effects line -->
        

        
            <script type="text/javascript" src="/js/mouse-click.js" content='[&quot;ğŸŒ±&quot;,&quot;just do it&quot;,&quot;ğŸŒ¾&quot;,&quot;ğŸ€&quot;,&quot;don&#39;t give up&quot;,&quot;ğŸ‚&quot;,&quot;ğŸŒ»&quot;,&quot;try it again&quot;,&quot;ğŸƒ&quot;,&quot;never say die&quot;,&quot;ğŸŒµ&quot;,&quot;ğŸŒ¿&quot;,&quot;ğŸŒ´&quot;]' color='[&quot;rgb(121,93,179)&quot; ,&quot;rgb(76,180,231)&quot; ,&quot;rgb(184,90,154)&quot; ,&quot;rgb(157,211,250)&quot; ,&quot;rgb(255,0,0)&quot; ,&quot;rgb(242,153,29)&quot; ,&quot;rgb(23,204,16)&quot; ,&quot;rgb(222,0,0)&quot; ,&quot;rgb(22,36,92)&quot; ,&quot;rgb(127,24,116)&quot; ,&quot;rgb(119,195,79)&quot; ,&quot;rgb(4,77,34)&quot; ,&quot;rgb(122,2,60)&quot;]'></script>
        

        <!-- background effects end -->
    

    <!--<script size="50" alpha='0.3' zIndex="-999" src="/js/ribbonStatic.js"></script>-->
    
        <script src="/js/ribbonDynamic.js"></script>
    
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>

</html>
